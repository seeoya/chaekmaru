<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/admin_layout}">

<head>
    <title>책마루 :: 관리자 HOME</title>
    
    <script src="./js/html2canvas.min.js" type="text/javascript"></script>    
   
    <script>
    document.addEventListener("DOMContentLoaded", function () {

		if (document.querySelectorAll(".btn-download")) {
                document.querySelectorAll(".btn-download").forEach(el => {
                    el.addEventListener("click", function (e) {
    	
				    html2canvas(document.querySelector("#capture_area")).then(canvas => {

						var today = new Date();
						var year = today.getFullYear();
						var month = ('0' + (today.getMonth() + 1)).slice(-2);
						var day = ('0' + today.getDate()).slice(-2);
						
						var dateString = year + month + day;
						
						console.log(dateString);

					var chart = document.createElement("a");
    				chart.href = canvas.toDataURL("image/jpeg");
    				chart.download = `chart${dateString}.png`; //다운로드 할 파일명 설정
    				chart.click();

   					});
				});
	
			});
		}

	});

	  
    </script>
    
	
</head>

<div id="admin-index" class="content-wrap" layout:fragment="content">
    
    <div class="content">
        <div class="admin-banner" th:if="${session.loginedAdminMemberDto == null}">
            <h2 class="title">관리자 HOME</h2>
            
			<div>
         	 <img th:src="@{/img/banner/addBanner3.png}">
         	 </div>

		</div>

          
  		<div class="admin-chart" th:unless="${session.loginedAdminMemberDto == null}">  							
  		  
  			<div class="chart-title">
			<h2 class="title">책마루&nbsp;&nbsp;매출&nbsp;&nbsp;BOARD</h2>
			<button type="button" class="btn-download btn main" >이미지 저장</button>					  							
			</div>
					
			<div class="chart-wrap" id="capture_area">
				<div class="chart-table">
					<div class="daily">            	
						<table>
							<thead>
								<tr class="t-title">
									<th colspan="2">일자별 매출현황</th>
								</tr>
								<tr>
									<th>매출일</th>
									<th>매출액</th>            		
								</tr>
							</thead>
								
							<tbody>
								<tr>
									<td>[[${date1}]]</td>
									<td data-th-text="${#numbers.formatInteger(sales1, 1, 'COMMA') + '원'}"></td>
										
								</tr>
								<tr>
									<td>[[${date2}]]</td>
									<td data-th-text="${#numbers.formatInteger(sales2, 1, 'COMMA') + '원'}"></td>     		
								</tr>
								<tr>
									<td>[[${date3}]]</td>
									<td data-th-text="${#numbers.formatInteger(sales3, 1, 'COMMA') + '원'}"></td>  		
								</tr>
								<tr>
									<td>[[${date4}]]</td>
									<td data-th-text="${#numbers.formatInteger(sales4, 1, 'COMMA') + '원'}"></td>		
								</tr>
								<tr>
									<td>[[${date5}]]</td>
									<td data-th-text="${#numbers.formatInteger(sales5, 1, 'COMMA') + '원'}"></td>          		
								</tr>
								<tr>
									<td>[[${date6}]]</td>
									<td data-th-text="${#numbers.formatInteger(sales6, 1, 'COMMA') + '원'}"></td>       		
								</tr>
								<tr>
									<td>[[${date7}]]</td>
									<td data-th-text="${#numbers.formatInteger(sales7, 1, 'COMMA') + '원'}"></td> 		
								</tr>
							</tbody>
						
						</table>
					</div>
								
					<div class="month">            
						<table>
							<thead>
								<tr class="t-title">
									<th colspan="3">카테고리별 매출현황</th>
								</tr>
								<tr>
									<th>카테고리</th>
									<th>전월 매출액</th>
									<th>당월 매출액</th>            		
								</tr>
							</thead>
								
							<tbody>
								<tr>            		
									<td>총&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;류</td>	            			 
									<td data-th-text="${#numbers.formatInteger(cate0, 1, 'COMMA') + '원'}"></td>
									<td data-th-text="${#numbers.formatInteger(cate10, 1, 'COMMA') + '원'}"></td>            		
								</tr>
								<tr>
									<td>철&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;학</td>
									<td data-th-text="${#numbers.formatInteger(cate1, 1, 'COMMA') + '원'}"></td>
									<td data-th-text="${#numbers.formatInteger(cate11, 1, 'COMMA') + '원'}"></td>           		
								</tr>
								<tr>
									<td>종&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;교</td>	            			
									<td data-th-text="${#numbers.formatInteger(cate2, 1, 'COMMA') + '원'}"></td>	            			
									<td data-th-text="${#numbers.formatInteger(cate12, 1, 'COMMA') + '원'}"></td>     		
								</tr>
								<tr>
									<td>사회과학</td>
									<td data-th-text="${#numbers.formatInteger(cate3, 1, 'COMMA') + '원'}"></td>
									<td data-th-text="${#numbers.formatInteger(cate13, 1, 'COMMA') + '원'}"></td>         		
								</tr>
								<tr>
									<td>자연과학</td>
									<td data-th-text="${#numbers.formatInteger(cate4, 1, 'COMMA') + '원'}"></td>
									<td data-th-text="${#numbers.formatInteger(cate14, 1, 'COMMA') + '원'}"></td>      		
								</tr>
								<tr>
									<td>기술과학</td>
									<td data-th-text="${#numbers.formatInteger(cate5, 1, 'COMMA') + '원'}"></td>
									<td data-th-text="${#numbers.formatInteger(cate15, 1, 'COMMA') + '원'}"></td>          		
								</tr>
								<tr>
									<td>예&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;술</td>
									<td data-th-text="${#numbers.formatInteger(cate6, 1, 'COMMA') + '원'}"></td>
									<td data-th-text="${#numbers.formatInteger(cate16, 1, 'COMMA') + '원'}"></td>         		
								</tr>
								<tr>
									<td>언&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;어</td>
									<td data-th-text="${#numbers.formatInteger(cate7, 1, 'COMMA') + '원'}"></td>
									<td data-th-text="${#numbers.formatInteger(cate17, 1, 'COMMA') + '원'}"></td>        		
								</tr>
								<tr>
									<td>문&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;학</td>
									<td data-th-text="${#numbers.formatInteger(cate8, 1, 'COMMA') + '원'}"></td>
									<td data-th-text="${#numbers.formatInteger(cate18, 1, 'COMMA') + '원'}"></td>   		
								</tr>
								<tr>
									<td>역&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;사</td>
									<td data-th-text="${#numbers.formatInteger(cate9, 1, 'COMMA') + '원'}"></td>
									<td data-th-text="${#numbers.formatInteger(cate19, 1, 'COMMA') + '원'}"></td>   		
								</tr>
							</tbody>
						
						</table>
					</div>
				</div>
			
			
				<div class="chart-chart">
					<th:block th:replace="include/js/admin_chart_js.html::admin_chart_js"></th:block>
				</div>
			</div>
		  </div>
		</div>		
	</div>
</html>
